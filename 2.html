<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Hackintosh" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>协议细节 - MPI&PPI 协议</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u534f\u8bae\u7ec6\u8282";
        var mkdocs_page_input_path = "2.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> MPI&PPI 协议
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">主页</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="1.html">协议介绍</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="2.html">协议细节</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#layer-1">Layer 1 物理层</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#layer-2">Layer 2 数据链路层</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#sd4">SD4 消息</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sd1">SD1 消息</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sc">SC 消息</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sd2">SD2 消息</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="3.html">协议实现</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="4.html">参考资料</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MPI&PPI 协议</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" alt="Docs"></a> &raquo;</li><li>协议细节</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">协议细节</h1>
<h2 id="layer-1">Layer 1 物理层</h2>
<p>物理层定义了对传输通道属性的要求。 MPI使用了</p>
<p>MPI使用UART 和RS485 来实现物理层的数据传输，</p>
<p>通用异步收发传输器（Universal Asynchronous Receiver/Transmitter，通常称为UART或串口），是一种异步收发传输器，将数据透过串列通信进行传输。UART通常用在与其他通信接口（如RS-485）的连接上。通用异步接受器-发送器(UART)把数据的字节按照比特顺序发送。另一端的UART把比特组装为字节。每个UART包含一个移位寄存器。通过一根线或其他介质的串行通信比通过多根线的并行通信具有更低成本。</p>
<p><img alt="image" src="imgs/FRAME.png" /></p>
<p><br><center>UART数据帧（图 2.1）</center><br/></p>
<p>MPI 协议规定数据帧格式为 1个开始位， 8个数据位，1个偶校验位，1个停止位，波特率有9.6K、19.2K 和 187.5K</p>
<p>RS-485 标准作为在物理层使用的选项，决定了通道的物理属性和总线上的数据编码。EIA-485(RS-485)只规范了信号发生器及接收器的电气特性，只建议了物理层，没有指定或是建议任何的通信协议.</p>
<p><img alt="image" src="imgs/RS485.jpeg" /></p>
<p><br><center>UART RS-485 连接示意图（图 2.2）</center><br/></p>
<p><img alt="image" src="imgs/LAYOUT.png" />
<br><center>实际物理连接示意图（图 2.3）</center><br/></p>
<p>在工业现场，MPI设备之间通过一个D型的9针母座与线缆相连接。</p>
<p><img alt="image" src="imgs/DB9.png" />
<br><center>D型的9针座（图 2.4）</center><br/></p>
<h2 id="layer-2">Layer 2 数据链路层</h2>
<p>层二有以下四种消息类型</p>
<ul>
<li>SD4消息：用于令牌传递</li>
<li>SD1消息：用于FDL状态查询，数据轮询和状态反馈</li>
<li>SC消息：用于没有数据的应答</li>
<li>SD2消息：用于数据请求和应答</li>
</ul>
<h3 id="sd4">SD4 消息</h3>
<p><center><img alt="image" src="imgs/SD4.png" /></center>
<br><center>SD4 消息类型</center><br/></p>
<p>SD4：消息头（0xDC）</p>
<p>DA：目的地址</p>
<p>SA：源地址</p>
<h3 id="sd1">SD1 消息</h3>
<p><center><img alt="image" src="imgs/SD1.png" /></center>
<br><center>SD1 消息类型</center><br/></p>
<p>SD1：消息头（0x10）</p>
<p>DA：目的地址</p>
<p>SA：源地址</p>
<p>FC：帧控制</p>
<p>-- 请求：49（FDL查询），5C、7C（交替）</p>
<p>-- 应答：02（无资源），03（无服务）</p>
<p>-- FDL应答：00（从站），01（主站未就绪），02（主站已就绪）
    03（主站已在令牌）</p>
<p>FCS：帧校验（DA到FC的数据和）</p>
<p>ED：帧结束（固定：0x16）</p>
<h3 id="sc">SC 消息</h3>
<p><center><img alt="image" src="imgs/SC.png" /></center>
<br><center>SC 消息类型</center><br/></p>
<p>SC：短应答（0xE5）</p>
<h3 id="sd2">SD2 消息</h3>
<p>MPI 和 PPI的SD2 消息类型有所不同
<center><img alt="image" src="imgs/SD2_MPI.png" /></center>
<br><center>MPI的SD2消息类型</center><br/></p>
<p><center><img alt="image" src="imgs/SD2_PPI.png" /></center>
<br><center>PPI的SD2消息类型</center><br/></p>
<p>SD2：消息头（0x68）</p>
<p>LE：长度</p>
<p>LEr：长度重复</p>
<p>DA：目的地址</p>
<p>SA：源地址</p>
<p>FC：帧控制，6C（首帧），5C、7C（交替）</p>
<p>DSAP：目的设备的服务点（SAP）</p>
<p>SSAP：来源设备的服务点</p>
<p>DataUnit：数据内容（层7信息）</p>
<p>FCS：帧校验（DA到DataUnit的数据和）</p>
<p>ED：帧结束（固定：0x16）</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="1.html" class="btn btn-neutral float-left" title="协议介绍"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="3.html" class="btn btn-neutral float-right" title="协议实现">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Co-Trust Inc</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="1.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="3.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
